## 第03章：版本控制与分支管理

### 一、什么是版本控制
在我们之前几章课程内容已经讲解了Git的基本用法，本节我们讲解Git的版本控制功能。

**查看历史版本**

Git是一个分布式版本控制工具，每一个客户端都会存放一个完整的版本库，每当我们使用git commit命令提交代码的时候，都会生成一个项目版本，我们可以使用git log命令查看当前项目的历史版本。

**版本控制功能的作用**

版本控制功能有什么作用呢？举一个简单的例子，我们的任务是完成一个电商网站的开发，当我们提交某一个版本之后，发现当前版本有一个重大的bug，为了修复这个bug，我们需要让程序撤销到某一个历史状态，显然我们用编辑器的撤销功能是不能完成这样的任务的，我们也不能为每一个历史版本都保存一个备份，以为这样会耗费大量的存储资源，这时候版本控制功能就派上用场了，我们可以使用简单的Git命令将项目切换到任何一个历史版本。这就是版本控制功能的作用。

### 二、版本控制命令

之前我们说过，可以使用git log查看历史版本信息，命令如下：

**查看历史版本**

``` bash
$ git log
commit 20ca0039afe8f7f57effd4687799b101a1240245
Author: ljyteach@163.com <test@163.com>
Date:   Fri Dec 1 09:05:40 2017 +0800

    备注信息1

commit e1a54ecd5472cb1e8b0445a9a9fd7edbda73420d
Author: test <test@test.com>
Date:   Mon Nov 27 17:29:23 2017 +0800

    备注信息2
```

**版本回溯**

执行git log之后可以看到commit后面包括了一串16进制数字，这就是我们的历史版本编号，我们可以通过这个编号跳转到任意历史版本。当然，这个编号有点长，为了方便操作，我们可以只输入这个编号的前七位，就能跳转到指定的版本，命令号如下：

``` bash
git reset --hard e1a54ec
```

通过上面的命令，我们就成功第跳转到了“备注信息2”的版本，再次打开我们项目目录，发现里面所有的文件都变成了e1a54ec这个版本的文件。这样我们就实现了版本的切换。

### 三、分支管理

**查看分支**

分支管理也是Git工具的一个非常重要的功能，举个简单的例子，我们还是编写一个电商网站项目，每天下班我们要提交自己的代码，但是我们不能保证当前提交的代码是一定可以正常运行的，如果本次提交的代码导致后台或前端程序不能正常运行，那这个代码就不能提交到master分支上，我们可以利用分支管理创建自己的分支或当前功能的分支，这样我们平时工作提交的代码就可以放在这个分支，而工作完成之后就可以把这个分支的代码合并到master分支。

使用git branch命令可以查看当前分支，默认情况下只有master分支。

**分支管理**

使用git branch <分支名>可以创建分支，实例代码如下：

``` bash
git branch test
```
执行上面的代码我们会创建一个名为test的分支，我们可以使用git branch查看，发现除了master之外又多了一个test分支。

执行下面命令：

``` bash
git checkout test
```

可以将当前的分支切换到test分支上，我们再编辑项目，就是在test分支上编辑，不会影响master分支的代码。

**合并分支**

当我们的工作完成后，需要将test分支上的代码合并到master分支上，需要先切换到master分支上，然后执行：

``` bash
git merge test
```
所有test分支上的代码就被合并到master上了。

